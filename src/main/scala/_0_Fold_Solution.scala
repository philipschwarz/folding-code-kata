import scala.annotation.tailrec

object _0_Fold_Solution extends App {

  // ð‘“ð‘œð‘™ð‘‘ð‘Ÿ âˆ· (ð›¼ â†’ ð›½ â†’ ð›½) â†’ ð›½ â†’ [ð›¼] â†’ ð›½
  // ð‘“ð‘œð‘™ð‘‘ð‘Ÿ ð‘“ ð‘’ [] = ð‘’
  // ð‘“ð‘œð‘™ð‘‘ð‘Ÿ ð‘“ ð‘’ (ð‘¥:ð‘¥ð‘ ) = ð‘“ ð‘¥ (ð‘“ð‘œð‘™ð‘‘ð‘Ÿ ð‘“ ð‘’ ð‘¥ð‘ )
  // ð‘–.ð‘’. ð‘“ð‘œð‘™ð‘‘ð‘Ÿ (âŠ•) ð‘’ [ð‘¥1,ð‘¥2,ð‘¥3] = ð‘¥1 âŠ• (ð‘¥2 âŠ• (ð‘¥3 âŠ• ð‘’))
  def foldr[A,B](f: A => B => B)(v: B)(s: List[A]): B = s match {
    case Nil   => v
    case x::xs => f(x)(foldr(f)(v)(xs))
  }

  // ð‘“ð‘œð‘™ð‘‘ð‘™ âˆ· (ð›½ â†’ ð›¼ â†’ ð›½) â†’ ð›½ â†’ [ð›¼] â†’ ð›½
  // ð‘“ð‘œð‘™ð‘‘ð‘™ ð‘“ ð‘’ [] = ð‘’
  // ð‘“ð‘œð‘™ð‘‘ð‘™ ð‘“ ð‘’ (ð‘¥:ð‘¥ð‘ ) = ð‘“ð‘œð‘™ð‘‘ð‘™ ð‘“ (ð‘“ ð‘’ ð‘¥) ð‘¥ð‘ 
  // ð‘–.ð‘’. ð‘“ð‘œð‘™ð‘‘ð‘™ (âŠ•) ð‘’ [ð‘¥1,ð‘¥2,ð‘¥3] = ((ð‘’ âŠ• ð‘¥1) âŠ• ð‘¥2) âŠ• ð‘¥3
  @tailrec
  def foldl[A,B](f: B => A => B)(e: B)(s: List[A]): B = s match {
    case Nil   => e
    case x::xs => foldl(f)(f(e)(x))(xs)
  }

  // ð‘ð‘Ÿð‘œð‘‘ âˆ· [ð¼ð‘›ð‘¡] â†’ ð¼ð‘›ð‘¡
  // ð‘ð‘Ÿð‘œð‘‘ = ð‘“ð‘œð‘™ð‘‘ð‘Ÿ (x) 0
  { val prod: List[Int] => Int = foldr(mult)(1)
    assert(prod(List(2, 3, 4)) == 24) }

  def mult: Int => Int => Int =
    m => n => m * n

  // ð‘ð‘Ÿð‘œð‘‘ âˆ· [ð¼ð‘›ð‘¡] â†’ ð¼ð‘›ð‘¡
  // ð‘ð‘Ÿð‘œð‘‘ = ð‘“ð‘œð‘™ð‘‘ð‘™ (x) 0
  { val prod: List[Int] => Int = foldl(mult)(1)
    assert(prod(List(2, 3, 4)) == 24) }

}
